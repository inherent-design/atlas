# ============================================
# Atlas Environment Configuration
# ============================================

# ============================================
# AI Service APIs (External)
# ============================================

# Voyage AI API Key (for embeddings + reranking)
# Get yours at: https://www.voyageai.com/
# If not set, falls back to Ollama for embeddings
VOYAGE_API_KEY=va-your-key-here

# Anthropic API Key (for LLM completions)
# If not set, falls back to Ollama for LLM
# ANTHROPIC_API_KEY=sk-ant-...

# ============================================
# Database Services (Local Docker)
# ============================================

# PostgreSQL Configuration (Metadata + Time-Series)
# Used for: Chunk metadata, QNTM keys, file tracking, analytics, time-series data
# Database: PostgreSQL 18 + TimescaleDB extension
POSTGRES_DB=atlas
POSTGRES_USER=atlas
POSTGRES_PASSWORD=atlas_dev_change_in_production

# PostgreSQL Connection URL (alternative to individual vars)
# If set, overrides POSTGRES_* vars above
# DATABASE_URL=postgresql://atlas:atlas_dev@localhost:5432/atlas

# Meilisearch Configuration (Full-Text Search)
# Used for: Hybrid search (semantic + keyword), typo-tolerant search
# Generate secure key: openssl rand -base64 32
MEILI_MASTER_KEY=atlas_dev_master_key_change_in_production

# Valkey/Redis Configuration (Hot Data Cache)
# Used for: QNTM key cache, collection stats cache, hot metadata
# Note: No password required for local development (not exposed to network)
# For production, consider adding password with --requirepass flag in docker-compose.yml
# REDIS_PASSWORD=  # Optional: for production deployments

# Qdrant Configuration (Vector Search)
# Used for: Semantic similarity search, vector embeddings
QDRANT_URL=http://localhost:6333
# QDRANT_API_KEY=  # Optional: for hosted Qdrant Cloud

# Ollama Configuration (Local LLM)
# Used for: Fallback embeddings and LLM completions when Voyage/Anthropic not available
OLLAMA_URL=http://localhost:11434

# ============================================
# Application Configuration
# ============================================

# Logging
LOG_LEVEL=info  # trace, debug, info, warn, error
# LOG_MODULES=ingest:debug,qntm/*:trace  # Module-specific overrides

# Environment
NODE_ENV=development  # development, production, test

# ============================================
# Service URLs (Default Values)
# ============================================
# These match the docker-compose.yml port mappings
# Only override if you're running services on different ports

# POSTGRES_HOST=localhost
# POSTGRES_PORT=5432

# VALKEY_HOST=localhost
# VALKEY_PORT=6379

# MEILISEARCH_URL=http://localhost:7700

# ============================================
# Storage Tier Configuration (Advanced)
# ============================================
# Control which storage tiers are enabled
# Options: 'enabled', 'disabled'

# STORAGE_CACHE_ENABLED=enabled      # Valkey cache (recommended for >10k chunks)
# STORAGE_ANALYTICS_ENABLED=enabled  # DuckDB analytics (recommended for >100k chunks)
# STORAGE_FULLTEXT_ENABLED=enabled   # Meilisearch search (recommended for hybrid search)

# ============================================
# Security Notes
# ============================================
# 1. Change all *_PASSWORD and *_KEY values before deploying to production
# 2. Use strong passwords: openssl rand -base64 32
# 3. Never commit .env.local to version control (.gitignore already configured)
# 4. For production, consider using secrets management (SOPS, Vault, etc.)

# ============================================
# Testing Services
# ============================================
# To verify services are running correctly:
#
# PostgreSQL:
#   docker exec -it atlas-postgres pg_isready -U atlas -d atlas
#   docker exec -it atlas-postgres psql -U atlas -d atlas -c "SELECT version();"
#
# Valkey:
#   docker exec -it atlas-valkey valkey-cli ping
#   curl http://localhost:6379  # Should reject (binary protocol)
#
# Meilisearch:
#   curl http://localhost:7700/health
#   curl -H "Authorization: Bearer ${MEILI_MASTER_KEY}" http://localhost:7700/version
#
# Qdrant:
#   curl http://localhost:6333/collections/atlas
#
# Ollama:
#   curl http://localhost:11434/api/tags
